/* Â©2014 Blizzard Entertainment, Inc. All rights reserved. */
'use strict';
var FormStatus={config:{},formComponentsQuery:"",datalessFormComponentsQuery:"",scrollableComponentsQuery:"",disabledClass:"",processingClass:"",element:null,formComponents:null,datalessFormComponents:null,scrollableComponents:null,activeButton:null,formComponentCount:0,datalessFormComponentCount:0,scrollableComponentCount:0,removeClassSearch:null,create:function(){var a=Object.create(this);a._construct.apply(a,arguments);return a;},_construct:function(a){a=typeof(a)==="undefined"?{}:a;this.config.formComponentsQuery=a.formComponentsQuery||"a.btn, button, div.select-box, input, span.input-checkbox, select, submit, textarea";this.config.datalessFormComponentsQuery=a.datalessFormComponentsQuery||"button, submit";this.config.scrollableComponentsQuery=a.scrollableComponentsQuery||".legal-agreement";this.config.disabledClass=a.disabledClass||"disabled";this.config.processingClass=a.processingClass||"processing";this.setup();},setup:function(){this.formComponentsQuery=this.config.formComponentsQuery;this.datalessFormComponentsQuery=this.config.datalessFormComponentsQuery;this.scrollableComponentsQuery=this.config.scrollableComponentsQuery;this.formComponents=document.querySelectorAll(this.formComponentsQuery);this.datalessFormComponents=document.querySelectorAll(this.datalessFormComponentsQuery);this.scrollableComponents=document.querySelectorAll(this.scrollableComponentsQuery);this.formComponentCount=this.formComponents.length;this.datalessFormComponentCount=this.datalessFormComponents.length;this.scrollableComponentCount=this.scrollableComponents.length;this.disabledClass=this.config.disabledClass;this.processingClass=this.config.processingClass;this.removeClassSearch=new RegExp("\\b"+this.disabledClass+"|"+this.processingClass+"\\b","g");},toggle:function(a,b,c){if(a){this._enableFields();this._toggleScrolling(true);}else{c=c||false;this.activeButton=b||null;this._disableFields(c);this._toggleScrolling(false);}},_enableFields:function(){for(var a=0;a<this.formComponentCount;a++){this.element=this.formComponents[a];this.element.className=this.element.className.replace(this.removeClassSearch,"");this.element.disabled=false;}},_disableFields:function(b){for(var a=0;a<this.formComponentCount;a++){this.element=this.formComponents[a];this.element.className+=" "+this.disabledClass;if(b){this.element.disabled=true;}}if(!b){for(var a=0;a<this.datalessFormComponentCount;a++){this.element=this.datalessFormComponents[a];this.element.disabled=true;}}if(this.activeButton){this.activeButton.className+=" "+this.processingClass;}},_toggleScrolling:function(a){for(var b=0;b<this.scrollableComponentCount;b++){this.element=this.scrollableComponents[b];this.element.style.overflowY=a?"auto":"hidden";}}};var Country={config:{},formQuery:"",inputCountryQuery:"",inputCountryPresentationQuery:"",currentCountryPresentationQuery:"",selectedCountryPresentationClass:"",$form:null,$inputCountry:null,$inputCountryPresentation:null,$dialogue:null,defaultCountry:"",oldCountry:"",newCountry:"",placeholder:false,create:function(){var a=Object.create(this);a._construct.apply(a,arguments);return a;},_construct:function(a){a=typeof(a)==="undefined"?{}:a;this.config=$.extend({formQuery:a.formQuery||"#change-country",inputCountryQuery:a.inputCountryQuery||"#country-list",inputHiddenCountryQuery:a.inputHiddenCountryQuery||"#hidden-country",minInputCountriesQuery:a.minInputCountriesQuery||"#change-country .dropdown-menu a",inputCountryPresentationQuery:a.countryPresentationQuery||"#select-box-country-list",currentCountryPresentationQuery:a.currentCountryPresentationQuery||".current .text",selectedCountryPresentationClass:a.selectedCountryPresentationClass||"selected",defaultCountry:a.defaultCountry||"",placeholder:a.placeholder||false},a);this.setup();},setup:function(){this.$form=$(this.config.formQuery);this.$inputCountry=$(this.config.inputCountryQuery);this.$inputHiddenCountry=$(this.config.inputHiddenCountryQuery);this.$minInputCountries=$(this.config.minInputCountriesQuery);this.oldCountry=this.$inputCountry.val();this.inputCountryPresentationQuery=this.config.inputCountryPresentationQuery;this.currentCountryPresentationQuery=this.config.currentCountryPresentationQuery;this.selectedCountryPresentationClass=this.config.selectedCountryPresentationClass;this.defaultCountry=this.config.defaultCountry;this.placeholder=this.config.placeholder;this.reset();this.registerEvents();},reset:function(){if(this.defaultCountry||this.placeholder){this.$inputCountry.val(this.defaultCountry);}},registerEvents:function(){this.$inputCountry.on("change",$.proxy(this.submit,this));this.$minInputCountries.on("click",$.proxy(this.submit,this));},submit:function(a){var b=this.$inputCountry.val()||$(a.target).data("alpha3");if(b!=this.oldCountry){this.newCountry=b;this.$inputHiddenCountry.val(b);this.$form.submit();}}};var Email={emailPattern:null,create:function(){var a=Object.create(this);a._construct.apply(a,arguments);return a;},_construct:function(a){a=typeof(a)==="undefined"?{}:a;this.emailPattern=a.emailPattern||new RegExp("^[0-9a-zA-Z+_.-]{1,64}@[0-9a-zA-Z_-]+\\.[0-9a-zA-Z_.-]+$");},check:function(a){return this.emailPattern.test(a);}};var Creation={config:{},containerQuery:"",formQuery:"",visibleFormComponentsQuery:"",unrestrictedInputFieldsQuery:"",inputParentsQuery:"",inputHelpQuery:"",selectsRequiredQuery:"",inputsRequiredQuery:"",inputEmailQuery:"",inputEmailConfirmationQuery:"",inputPasswordQuery:"",inputPasswordConfirmationQuery:"",passwordRatingQuery:"",inputAgeQuery:"",inputDobDayQuery:"",inputDobMonthQuery:"",inputDobYearQuery:"",inputParentEmailQuery:"",containerCaptchaQuery:"",imageCaptchaQuery:"",iconCaptchaReloadQuery:"",buttonSubmitQuery:"",buttonCancelQuery:"",errorContainerTemplateQuery:"",alertContainerQuery:"",promoVideo:"",errorClass:"",loadingClass:"",$container:null,$form:null,$visibleFormComponents:null,$unrestrictedInputFields:null,$selectsRequired:null,$inputsRequired:null,$inputEmail:null,$inputEmailConfirmation:null,$inputPassword:null,$inputPasswordConfirmation:null,$passwordRating:null,$inputAge:null,$inputDobDay:null,$inputDobMonth:null,$inputDobYear:null,$inputParentEmail:null,$containerCaptcha:null,$imageCaptcha:null,$iconCaptchaReload:null,$buttonSubmit:null,$buttonCancel:null,$errorContainerTemplate:null,$promoVideo:null,$agreedToPrivacyPolicy:null,$agreedToToU:null,$inputSqa:null,urlCaptcha:"",goodEmail:false,goodPassword:false,matchingPassword:false,goodAge:false,goodParentEmail:false,enterToNextField:false,skipPrivacyPolicy:false,agreedToPrivacyPolicy:false,validatorEmail:null,validatorPassword:null,formStatus:null,dataLayer:null,captchaReloadTimer:false,captchaReloadAnimationLength:0,validNumberInputNonCharacterKeyCodes:[8,9,13,27,37,38,39,40,46],create:function(){var a=Object.create(this);a._construct.apply(a,arguments);return a;},_construct:function(a){a=typeof(a)==="undefined"?{}:a;this.config=$.extend({containerQuery:a.containerQuery||"#form-container",formQuery:a.formQuery||"#account-creation",visibleFormComponentsQuery:a.visibleFormComponentsQuery||"select, input[type='text'], input[type='email'], input[type='password'], input[type='number']",unrestrictedInputFieldsQuery:a.unrestrictedInputFieldsQuery||"input[type='text']",inputParentsQuery:a.inputParentsQuery||".control-group",inputHelpQuery:a.inputHelpQuery||".help-block",selectsRequiredQuery:a.selectsRequiredQuery||"select[required]",inputsRequiredQuery:a.inputsRequiredQuery||"#account-creation [required]",inputEmailQuery:a.inputEmailQuery||"#emailAddress",inputEmailConfirmationQuery:a.inputEmailConfirmationQuery||"#emailAddressConfirmation",inputPasswordQuery:a.inputPasswordQuery||"#password",inputPasswordConfirmationQuery:a.inputPasswordConfirmationQuery||"#rePassword",passwordRatingQuery:a.passwordRatingQuery||".password-rating",inputAgeQuery:a.inputAgeQuery||"#age",inputDobDayQuery:a.inputDobDayQuery||"#dobDay",inputDobMonthQuery:a.inputDobMonthQuery||"#dobMonth",inputDobYearQuery:a.inputDobYearQuery||"#dobYear",inputParentEmailQuery:a.inputParentEmailQuery||"#parentContactEmail",containerCaptchaQuery:a.containerCaptchaQuery||".row-captcha",imageCaptchaQuery:a.imageCaptchaQuery||"#security-image",iconCaptchaReloadQuery:a.iconCaptchaReloadQuery||".captcha-reloader",buttonSubmitQuery:a.buttonSubmitQuery||"#account-creation button[type='submit']",buttonCancelQuery:a.buttonCancelQuery||"#creation-cancel-button",errorContainerTemplateQuery:a.errorContainerTemplateQuery||".templates .alert-error",alertContainerQuery:a.alertContainerQuery||".alert",promoVideoQuery:a.promoVideoQuery||".promo-video",passwordGuidelinesQuery:a.passwordGuidelinesQuery||"#wellPasswordGuidelines",agreedToPrivacyPolicyQuery:a.agreedToPrivacyPolicyQuery||"#agreedToPrivacyPolicy",agreedToToUQuery:a.agreedToToUQuery||"#agreedToToU",inputSqaQuery:a.inputSqaQuery||"#question1",errorClass:a.errorClass||"control-error text-error",loadingClass:a.loadingClass||"loading",urlCaptcha:a.urlCaptcha||"/account/captcha.jpg",enterToNextField:a.enterToNextField||false,skipPrivacyPolicy:a.skipPrivacyPolicy||false,validatorEmail:a.validatorEmail||Email.create(),validatorPassword:a.validatorPassword||null,formStatus:a.formStatus||null,dataLayer:a.dataLayer||null,captchaReloadAnimationLength:a.captchaReloadAnimationLength||500},a);this.setup();},setup:function(){this.visibleFormComponentsQuery=this.config.visibleFormComponentsQuery;this.inputParentsQuery=this.config.inputParentsQuery;this.inputHelpQuery=this.config.inputHelpQuery;this.iconCaptchaReloadQuery=this.config.iconCaptchaReloadQuery;this.alertContainerQuery=this.config.alertContainerQuery;this.$container=$(this.config.containerQuery);this.$form=$(this.config.formQuery);this.$visibleFormComponents=$(this.config.visibleFormComponentsQuery);this.$unrestrictedInputFields=$(this.config.unrestrictedInputFieldsQuery);this.$selectsRequired=$(this.config.selectsRequiredQuery);this.$inputsRequired=$(this.config.inputsRequiredQuery);this.$inputEmail=$(this.config.inputEmailQuery);this.$inputEmailConfirmation=$(this.config.inputEmailConfirmationQuery);this.$inputPassword=$(this.config.inputPasswordQuery);this.$inputPasswordConfirmation=$(this.config.inputPasswordConfirmationQuery);this.$passwordRating=$(this.config.passwordRatingQuery);this.$inputAge=$(this.config.inputAgeQuery);this.$inputDobDay=$(this.config.inputDobDayQuery);this.$inputDobMonth=$(this.config.inputDobMonthQuery);this.$inputDobYear=$(this.config.inputDobYearQuery);this.$inputParentEmail=$(this.config.inputParentEmailQuery);this.$containerCaptcha=$(this.config.containerCaptchaQuery);this.$imageCaptcha=$(this.config.imageCaptchaQuery);this.$iconCaptchaReload=$(this.iconCaptchaReloadQuery);this.$buttonSubmit=$(this.config.buttonSubmitQuery);this.$buttonCancel=$(this.config.buttonCancelQuery);this.$errorContainerTemplate=$(this.config.errorContainerTemplateQuery);this.$promoVideo=$(this.config.promoVideoQuery);this.$passwordGuidelines=$(this.config.passwordGuidelinesQuery);this.$agreedToPrivacyPolicy=$(this.config.agreedToPrivacyPolicyQuery);this.$agreedToToU=$(this.config.agreedToToUQuery);this.$inputSqa=$(this.config.inputSqaQuery);this.errorClass=this.config.errorClass;this.loadingClass=this.config.loadingClass;this.urlCaptcha=this.config.urlCaptcha;this.enterToNextField=this.config.enterToNextField;this.skipPrivacyPolicy=this.config.skipPrivacyPolicy;this.validatorEmail=this.config.validatorEmail;this.validatorPassword=this.config.validatorPassword;if(this.config.formStatus){this.formStatus=this.config.formStatus;}if(this.config.dataLayer){this.dataLayer=this.config.dataLayer;}this.captchaReloadAnimationLength=this.config.captchaReloadAnimationLength;this.registerEvents();this.preventOnclickAttributes();this.setupUserAgentBehaviors();this.submitActions();},preventOnclickAttributes:function(){$("a[rel=external][onclick]").each(function(){$(this).removeAttr("onclick");if(!window.phoenix){$(document).on("click","a[rel=external]",function(){$(this).attr("target","_blank");});}});},registerEvents:function(){var a=this;$(function(){$(window).on("resize",function(){var b=a.$promoVideo.width();var e=a.$promoVideo.height();var d=e/b;var c=a.$promoVideo.parent().width();if(b<10){return;}a.$promoVideo.width(c);a.$promoVideo.height(c*(e/b));}).trigger("resize");});$(function(){$(".show-password").on("click",function(){var b=$(".show-password i");if(b.hasClass("icon-eye-open")){b.removeClass("icon-eye-open");b.addClass("icon-eye-close");$("#password").attr("type","text");}else{b.removeClass("icon-eye-close");b.addClass("icon-eye-open");$("#password").attr("type","password");}});});this.$form.on("click",".password-guidelines-trigger",function(){$("#password").popover("toggle");});this.$visibleFormComponents.on("keypress",$.proxy(this.handleEnterKeystroke,this));this.$unrestrictedInputFields.on("focusout",$.proxy(this.revalidateTextField,this));this.$form.on("submit",$.proxy(this.validate,this));this.$inputEmail.on("focusout",$.proxy(this.validateEmail,this,this.$inputEmail,false));this.$inputEmailConfirmation.on("focusout",$.proxy(this.validateEmail,this,this.$inputEmailConfirmation,false));this.$inputPasswordConfirmation.on("keyup focusout",$.proxy(this.comparePasswords,this));this.$inputAge.on("input keyup change",$.proxy(this.filterNonNumeric,this));this.$inputDobDay.on("input keyup change",$.proxy(this.filterNonNumeric,this));this.$inputDobYear.on("input keyup change",$.proxy(this.filterNonNumeric,this));this.$inputDobDay.on("focusout",$.proxy(this.validateDobDay,this));this.$inputDobYear.on("focusout",$.proxy(this.validateDobYear,this));this.$inputDobMonth.on("change",$.proxy(this.validateDobMonth,this));this.$inputParentEmail.on("focusout",$.proxy(this.validateEmail,this,this.$inputParentEmail,true));this.$agreedToPrivacyPolicy.on("click",$.proxy(this.checkPrivacy,this));this.$agreedToToU.on("click",$.proxy(this.checkTou,this));this.$inputSqa.on("change",$.proxy(this.checkSqa,this));this.$containerCaptcha.on("click",$.proxy(this.refreshCaptcha,this));if(this.formStatus){this.$buttonCancel.on("click",$.proxy(this.formStatus.toggle,this,false,this.$buttonCancel[0],true));}$(".success-content .email > div").fitText();},handleEnterKeystroke:function(a){var b=a.currentTarget;if(a.which==13&&b.tagName!="select"){if(this.enterToNextField){$(b).parents(this.inputParentsQuery).next(this.inputParentsQuery).children(this.visibleFormComponentsQuery).trigger("focus");}a.preventDefault();}},revalidateTextField:function(a){var b=a.currentTarget;if(b.value){this.toggleErrorState($(b),true);}},getErrorMessage:function(c){c=c.split(".");var d=messages.errors;var b,a;for(b=0;b<c.length;b++){a=c[b];if(a&&d[a]){d=d[a];}else{return messages.errors.unknown;}}return d;},validate:function(){var a=this,b=false,c=false,d=[];if(this.formStatus){this.formStatus.toggle(false,this.$buttonSubmit[0]);}this.toggleErrorState(this.$inputsRequired,true);$.each(this.$inputsRequired,function(e,f){if(!($.trim(f.value))&&f.id){b=true;a.toggleErrorState($(f),false);}});if(b){c=true;d.push(Creation.getErrorMessage("blank"));}if(this.$inputEmail.length>0&&!this.validateEmail(this.$inputEmail)&&this.$inputEmail.val()!=""&&!this.goodEmail){c=true;this.toggleErrorState(this.$inputEmail,false,Creation.getErrorMessage("email.message"));}if($(".passwordGuidelines .failing").length>0){c=true;this.toggleErrorState(this.$inputPassword,false,Creation.getErrorMessage("password.message"));}if(this.$inputPasswordConfirmation.length&&this.$inputPasswordConfirmation.val()!=""&&!this.matchingPassword){c=true;this.toggleErrorState(this.$inputPasswordConfirmation,false,Creation.getErrorMessage("rePassword.message"));}if(this.$inputAge.length){this.goodAge=!isNaN(this.$inputAge.val())&&this.$inputAge.val()!="";if(!this.goodAge){c=true;this.toggleErrorState(this.$inputAge,false,Creation.getErrorMessage("age.message"));}}if(!this.$agreedToPrivacyPolicy.prop("checked")&&!this.skipPrivacyPolicy){c=true;this.toggleErrorState(this.$agreedToPrivacyPolicy,false);this.toggleErrorState(this.$agreedToPrivacyPolicy.parent(),false);}if(!this.validateEmail(this.$inputParentEmail)&&this.$inputParentEmail.length&&this.$inputParentEmail.val()!=""&&!this.goodParentEmail){c=true;this.toggleErrorState(this.$inputParentEmail,false,Creation.getErrorMessage("email.message"));}if(this.$inputDobYear.length&&(!this.validateDobYear()||!this.validateDobMonth()||!this.validateDobDay())){c=true;}if(c){if(this.formStatus){this.formStatus.toggle(true);}$("form #creation-submit-button").button("reset");this.showAlert(d);return false;}else{return true;}},validateEmail:function(e,d){var a,c=false,b="";if(d){this.goodParentEmail=this.validatorEmail.check(e.val());a=this.goodParentEmail;}else{this.goodEmail=this.validatorEmail.check(e.val());a=this.goodEmail;}c=a||(!e.val()&&!this.hasError(e));if(e.val()){b=Creation.getErrorMessage("email.message");}this.toggleErrorState(e,c,b);},validatePassword:function(b){var a=this.validatorPassword.rate(this.$inputPassword.val(),this.$inputEmail.val()),e=false,c="";if(a){this.$passwordRating.html(messages.ratings[a]).removeClass("short weak fair strong").addClass(a);}else{this.$passwordRating.html("");}var d=function(g){g.removeClass("text-success").addClass("text-error");var f=g.find("i");f.removeClass("icon-green").addClass("icon icon-red icon-exclamation-circle");};this.goodPassword=a=="strong"||a=="fair";e=this.goodPassword||(!this.$inputPassword.val()&&!this.hasError(this.$inputPassword));if(this.$inputPassword.val()){c=Creation.getErrorMessage("password.message")+'<i class="icon-question-circle icon-16" onclick="$(\'#passwordGuidelines\').modal();"></i>';}},comparePasswords:function(a){var c=this.$inputPassword.val(),b=this.$inputPasswordConfirmation.val();if(a.type=="keyup"){c=c.substring(0,b.length);}this.matchingPassword=c==b;this.toggleErrorState(this.$inputPasswordConfirmation,b&&this.matchingPassword,Creation.getErrorMessage("rePassword.message"));},validateDobYear:function(){var b=true;if(this.$inputDobYear.length){var a=this.$inputDobYear.val();b=a!=""&&a.length==4&&!isNaN(a)&&a>=1899;}this.toggleErrorState(this.$inputDobYear,b);return b;},validateDobMonth:function(){var a=true;if(this.$inputDobMonth.length){var b=this.$inputDobMonth.val();a=b!=""&&!isNaN(b);}this.toggleErrorState(this.$inputDobMonth,a);return a;},validateDobDay:function(){var a=true;if(this.$inputDobDay.length){var b=this.$inputDobDay.val();a=b!=""&&(b.length==1||b.length==2)&&!isNaN(b)&&b>=1&&b<=31;}this.toggleErrorState(this.$inputDobDay,a);return a;},filterNonNumeric:function(b){var a=$(b.target);a.val(a.val().replace(/[^0-9]/g,""));if(this.$inputAge.val()){this.toggleErrorState(this.$inputAge,true);}},checkPrivacy:function(a){if(this.$agreedToPrivacyPolicy.prop("checked")&&!this.skipPrivacyPolicy){this.toggleErrorState(this.$agreedToPrivacyPolicy,true);}},checkTou:function(a){if(this.$agreedToToU.prop("checked")){this.toggleErrorState(this.$agreedToToU,true);}},checkSqa:function(a){if(this.$inputSqa.val){this.toggleErrorState($("#select-box-question1"),true);}},refreshCaptcha:function(){var a=this;this.$imageCaptcha.attr("src",this.urlCaptcha+"?"+new Date().getTime());this.$iconCaptchaReload.addClass(this.loadingClass);this.captchaReloadTimer=setTimeout(function(){$(a.iconCaptchaReloadQuery).removeClass(a.loadingClass);},this.captchaReloadAnimationLength);},toggleErrorState:function(c,d,b){b=b||"";var e=c.parents(this.inputParentsQuery),a=c.siblings(this.inputHelpQuery);if(d){e.removeClass(this.errorClass);a.html("");}else{e.addClass(this.errorClass);if(b){a.html('<i class="icon-remove icon-red"></i>'+b);if(this.dataLayer){this.dataLayer.push({event:"gtm.message","error-inline":c.attr("id")});}}else{a.html("");}}},showAlert:function(b){b=b||[];var a=this.$errorContainerTemplate.clone(),d="";var c=this;if(b.length){$.each(b,function(e,f){d+="<li>"+f.message+"</li>";if(c.dataLayer){c.dataLayer.push({event:"gtm.message","error-box":f.code});}});d="<ul>"+d+"</ul>";}d=Creation.getErrorMessage("header.message")+d;this.$container.find(this.alertContainerQuery).remove();a.append(d);this.$container.prepend(a);window.scrollTo(0,0);},hasError:function(a){return a.parents(this.inputParentsQuery).hasClass(this.errorClass);},setLoginCsrfToken:function(a){$(".account-creation-oauth-form input[name='csrftoken'][value='-']").val(a);$(".account-creation-oauth-form button").prop("disabled",false);},requestLoginCsrfToken:function(b){var a=this;$.ajax({url:b,success:function(c){if($.type(c)!="string"){a.setLoginCsrfToken(c.getElementById("csrftoken").value);}else{html=$("div",c);a.setLoginCsrfToken(html.find("#csrftoken").value);}},error:function(){a.setLoginCsrfToken("-");}});},setupUserAgentBehaviors:function(){if(!/(iPhone|iPad|iPod|Android)/ig.test(navigator.userAgent)){$("#age").attr("type","text");$("#dobDay").attr("type","text");$("#dobYear").attr("type","text");if(!window.phoenix){$("input#firstname").focus();}}},submitActions:function(){$("form").on("click",'.btn:not([rel="external"])',function(a){$(a.target).button("loading");});}};(function(a){a.fn.fitText=function(d,b){var e=d||1,c=a.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},b);return this.each(function(){var f=a(this);var g=function(){f.css("font-size",Math.max(Math.min(f.width()/(e*10),parseFloat(c.maxFontSize)),parseFloat(c.minFontSize)));};g();a(window).on("resize.fittext orientationchange.fittext",g);});};})(jQuery);var BattleTag={$modal:"",$inputBattleTag:"",$buttonSubmit:"",$errors:"",$buttonChangeBattleTag:"",$labelBattleTag:"",$labelBattleTagNumber:"",$questions:"",urlEndpoint:"/account/management/battletag/create",init:function(){BattleTag.$modal=$("#modal-battletag");BattleTag.$inputBattleTag=$("input[name=battleTag]");BattleTag.$buttonSubmit=$("#modal-battletag button[type=submit]");BattleTag.$errors=$("#modal-battletag .errors");BattleTag.$buttonChangeBattleTag=$("[data-target=#modal-battletag]");BattleTag.$labelBattleTag=$(".battletag .success-accountName .battleTagName");BattleTag.$labelBattleTagNumber=$(".battletag .success-accountName .battleTagNumber");BattleTag.$questions=$(".battletag h6");BattleTag.bindEvents();},bindEvents:function(){BattleTag.$buttonSubmit.on("click",function(a){return BattleTag.submit();});BattleTag.$questions.on("click",function(a){$(this).next("p").toggleClass("open");});},submit:function(){BattleTag.attemptBattleTagChange(this.$inputBattleTag.val());},attemptBattleTagChange:function(a){$.post(BattleTag.urlEndpoint,{battleTag:BattleTag.$inputBattleTag.val()},BattleTag.handleResponse,"json");},handleResponse:function(b){BattleTag.$errors.empty();if(b.success){BattleTag.$modal.modal("hide");BattleTag.$labelBattleTag.text(b.battleTagName);BattleTag.$labelBattleTagNumber.text(b.battleTagNumber);BattleTag.$buttonChangeBattleTag.remove();}else{for(var a in b.errorMessages){BattleTag.$errors.append('<li class="text-error"><i class="icon icon-alert icon-red"></i>'+b.errorMessages[a]+"</li>");}}}};$(BattleTag.init());